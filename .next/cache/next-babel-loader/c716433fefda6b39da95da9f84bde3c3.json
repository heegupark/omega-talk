{"ast":null,"code":"import Room from '../../middleware/models/room';\n\nrequire('../../middleware/db/mongoose');\n\nexport default (async (request, response) => {\n  const {\n    _id,\n    username,\n    message\n  } = request.body;\n\n  try {\n    const room = await Room.findOne({\n      _id\n    });\n\n    if (!room) {\n      return response.status(404).json({\n        success: false,\n        message: 'failed to find a room'\n      });\n    }\n\n    await room.messages.push({\n      username,\n      message\n    });\n    room.save();\n    const result = room.messages[room.messages.length - 1]; // request.io.sockets.emit(`room-${_id}`, { success: true, data: result });\n\n    return response.status(201).json({\n      success: true,\n      data: result\n    });\n  } catch (e) {\n    return response.status(500).json({\n      success: false,\n      message: 'failed to send a message'\n    });\n  }\n});","map":null,"metadata":{},"sourceType":"module"}